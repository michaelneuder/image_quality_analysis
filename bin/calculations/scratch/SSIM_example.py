#!/usr/bin/env python3
import numpy as np
import scipy as sp

def main():
    orig = np.asarray(
        [[61,67,70,75,74,70,70,70,70,70,70],
         [73,69,68,65,71,72,72,72,72,72,72],
         [67,68,69,69,73,71,71,71,71,71,71],
         [68,68,70,76,81,82,82,82,82,82,82],
         [74,77,79,78,80,85,85,85,85,85,85],
         [71,77,78,78,76,80,80,80,80,80,80],
         [71,77,78,78,76,80,80,80,80,80,80],
         [71,77,78,78,76,80,80,80,80,80,80],
         [71,77,78,78,76,80,80,80,80,80,80],
         [71,77,78,78,76,80,80,80,80,80,80],
         [71,77,78,78,76,80,80,80,80,80,80]])
    recon = np.asarray(
        [[69,68,71,80,82,77,77,77,77,77,77],
         [77,71,71,79,88,79,79,79,79,79,79],
         [73,71,74,81,87,79,79,79,79,79,79],
         [73,69,76,81,89,82,82,82,82,82,82],
         [73,68,74,81,83,80,80,80,80,80,80],
         [70,72,72,79,80,79,79,79,79,79,79],
         [70,72,72,79,80,79,79,79,79,79,79],
         [70,72,72,79,80,79,79,79,79,79,79],
         [70,72,72,79,80,79,79,79,79,79,79],
         [70,72,72,79,80,79,79,79,79,79,79],
         [70,72,72,79,80,79,79,79,79,79,79]])

    orig_data = orig.flatten()
    recon_data = recon.flatten()
    k_1 = 0.01
    k_2 = 0.03
    L = 255
    mean_x = np.mean(orig_data)
    mean_y = np.mean(recon_data)
    print('means: ', mean_x, ', ', mean_y)
    var_x = np.var(orig_data)
    var_y = np.var(recon_data)
    print('vars : ', var_x, ', ', var_y)
    covar = np.cov(orig_data, recon_data)[0][1]
    print('covar: ', covar)
    c_1 = (L*k_1)**2
    c_2 = (L*k_2)**2
    print('c1, c2 : ', c_1, ', ', c_2)
    num = (2*mean_x*mean_y+c_1)*(2*covar+c_2)
    den = (mean_x**2+mean_y**2+c_1)*(var_x+var_y+c_2)
    print('SSIM : ', num/den)

if __name__ == '__main__':
    main()
